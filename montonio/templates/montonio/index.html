<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Montonio SDK</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <style>
      @import url(https://fonts.googleapis.com/css?family=Oswald:400,700,300);
@import url(https://fonts.googleapis.com/css?family=Open+Sans:300,400,600);
body {
  background-color: #24282e;
  font-family: "Open Sans", sans-serif;
  display: flex;
  justify-content: center;
  padding: 50px 0;
}

.donate {
  /*padding: 50px*/
  background-color: #171b24;
  width: 500px;
  color: #FFF;
}

.donate p {
  line-height: 24px;
  font-size: 14px;
  font-weight: 300;
}

.donate h3 {
  font-size: 14px;
  font-weight: 300;
  margin-bottom: 30px;
}

.denomination {
  float: left;
  width: 33%;
  text-align: center;
  padding: 13px 0;
  cursor: pointer;
  background-color: #171b24;
  margin: 0 1px 1px 0;
  transition: background-color 0.2s ease;
}

.denomination label {
  font-weight: 600;
  cursor: pointer;
}

.denomination input {
  left: -10001px;
  position: absolute;
}

.denomination-other {
  width: 99.8%;
}

.denomination-other input {
  position: relative;
  color: #FFF;
  font-size: 14px;
  font-weight: 600;
  width: inherit;
  text-align: center;
  background-color: #171b24;
  border: none;
  padding: 13px 0;
  transition: background-color 0.2s ease;
}

.denomination-other input:hover {
  background-color: #ec3029;
}

.denomination-other input:before {
  position: absolute;
  left: 6px;
  top: 2px;
  content: "$";
}

.donate-amount .selected, .denomination-other input.selected, .donate-amount .denomination:hover {
  background-color: #EC3029;
  border: 0;
}

.donate-black h2 {
  font-family: "Oswald", sans-serif;
  color: #FFF;
  font-size: 32px;
  margin-bottom: 30px;
}

.donate-black h2 span {
  display: block;
  float: left;
  font-size: 16px;
  padding-top: 7px;
  margin-right: 20px;
  text-align: center;
  width: 30px;
  height: 25px;
  background-color: #ec3029;
  border-radius: 50%;
}

.donate-type label,
.donate-payment label {
  font-size: 14px;
  font-weight: 300;
  margin-right: 30px;
}

.donate-blue {
  background-color: #1e252d;
  padding: 25px;
}

.donate-black {
  padding: 25px;
}

.donate-submit button {
  font-family: "Oswald", sans-serif;
  width: 100%;
  background-color: #ec3029;
  border: none;
  color: #FFF;
  font-size: 20px;
  line-height: 20px;
  padding: 14px 0;
  margin: 30px 0;
  text-transform: uppercase;
  cursor: pointer;
}

.donate-submit small {
  color: rgba(255, 255, 255, 0.4);
  font-size: 13px;
}

::-webkit-input-placeholder {
  color: #FFF;
  font-size: 14px;
  font-weight: 300;
}

:-moz-placeholder {
  color: #FFF;
  font-weight: 300;
}

::-moz-placeholder {
  color: #FFF;
  font-weight: 300;
}

:-ms-input-placeholder {
  font-weight: 300;
  color: #FFF;
}

*:focus {
  outline: none;
}
    </style>
</head>
<body>
    <form id="my-checkout" novalidate>
{#        {% csrf_token %}#}
{#        <input id="montonio-checkout-user" name="montonio-checkout-user" type="text" placeholder="Nimi" value="" />#}
{#        <input id="montonio-checkout-amount" name="montonio-checkout-amount" type="text" placeholder="Summa" value="9.99" />#}

        <div class="donate">
          <div class="donate-black">
            <h2>Anneta stipendiumifondi</h3>
            <p>Võimalik on valida õpilase või õpetaja stipendiumifondi vahel.</p>
          </div>
          <div class="donate-blue">
            <h3>Annetuse summa*</h3>
            <div class="donate-amount-box">
              <div class="donate-amount">
                <div class="denomination selected">
                  <input autocomplete="off" type="radio" name="amount" id="amount5" value="5" checked="">
                  <label for="amount5">5€</label>
                </div>
                <div class="denomination">
                  <input autocomplete="off" type="radio" name="amount" id="amount10" value="10">
                  <label for="amount10">10€</label>
                </div>
                <div class="denomination">
                  <input autocomplete="off" type="radio" name="amount" id="amount15" value="15">
                  <label for="amount15">15€</label>
                </div>
                <div class="denomination">
                  <input autocomplete="off" type="radio" name="amount" id="amount25" value="25">
                  <label for="amount25">25€</label>
                </div>
                <div class="denomination">
                  <input autocomplete="off" type="radio" name="amount" id="amount50" value="50">
                  <label for="amount50">50€</label>
                </div>
                <div class="denomination">
                  <input autocomplete="off" type="radio" name="amount" id="amount100" value="100">
                  <label for="amount100">100€</label>
                </div>
              </div>
              <div class="denomination-other">
                <input autocomplete="off" type="text" name="amountother" value="" placeholder="Sisesta oma summa">
              </div>
            </div>
          </div>
          <div class="donate-black donate-type">
            <h3>Annetan*</h3>
            <label>
                  <input type="radio" name="donation_type" value="studentFund" checked="checked" autocomplete="off" class="required">
                  Õpilaste stipendiumi jaoks
            </label>
            <label>
                  <input type="radio" name="donation_type" value="teacherFund" autocomplete="off" class="required">
                  Õpetajate stipendiumi jaoks
            </label>
          </div>
          <div class="donate-blue donate-payment">
            <h3>Vali maksekanal</h3>
            <!-- This is the target div -->
            <div id="montonio-checkout"></div>
{#            <div>#}
{#              <label>#}
{#                <input type="radio" name="payment" value="paypal" checked="checked" autocomplete="off">PayPal#}
{#              </label>#}
{#              <label>#}
{#                <input type="radio" name="payment" value="crypto" autocomplete="off">Cryptocurrency#}
{#              </label>#}
{#            </div>#}
            <div class="donate-submit">
              <button type="submit" autocomplete="off">Anneta 5€</button>
              <p><small>Annetused stipendiumifondi on tulumaksuvabad.</small></p>
            </div>
          </div>
        </div>
        <div id="answer"></div>
{#        <button type="submit">Submit</button>#}
    </form>

    <script>
      $(".denomination").click(function(event) {
        $(".denomination").removeClass("selected").prop('checked', false);
        $(".denomination-other input").removeClass("selected").val('');
        $(this).addClass("selected");
        $(this).children(":first").prop('checked', true);
        $("button").text('Anneta ' + $(this).children(":first").val() + '€')
      });

      $(".denomination-other input").on('keypress', function (event) {
        // allow only int values
        // TODO: remove leading 0
        var regex = new RegExp("^[0-9]+$");
        var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
        if (!regex.test(key)) {
          event.preventDefault();
          return false;
        }

        $(".denomination").removeClass("selected").prop('checked', false);
        $(this).addClass("selected");
        $("button").text('Anneta ' + $(this).val() + key + '€');
      });
    </script>

    <script>
        function setAnswer(text) {
          answer.innerHTML = text;
          data = JSON.parse(text);
          console.log(data);
        }

        // Make sure to wrap your code in the window.onMontonioLoaded function
        window.onMontonioLoaded = function() {
            var checkout = Montonio.Checkout.PaymentInitiation.create({
                accessKey: '{{ my_access_key}}',
                // The JSON string obtained from the HTTP request GET /stores/payment-methods.
                storeSetupData: '{"uuid": "b6080898-2d54-4fd0-85c8-8ae628c9f976", "name": "Valga G\u00fcmnaasiumi Vilistlaskogu", "paymentMethods": {"paymentInitiation": {"processor": "montonio", "setup": {"DE": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "Sparkasse", "logoUrl": "https://public.montonio.com/images/aspsps_logos/sparkasse.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "DEMO_UI_GROUPED"}, {"name": "Ing DiBa", "logoUrl": "https://public.montonio.com/images/aspsps_logos/ing.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "INGDDEFF"}, {"name": "Deutsche Bank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/deutschebank.png", "supportedCurrencies": ["EUR"], "uiPosition": 6, "code": "DEUTDEFFXXX"}, {"name": "Noris Bank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/noris.png", "supportedCurrencies": ["EUR"], "uiPosition": 7, "code": "NORSDE51XXX"}, {"name": "Commerzbank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/commerzbank.png", "supportedCurrencies": ["EUR"], "uiPosition": 8, "code": "COBADEFF"}, {"name": "N26 Germany", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/n26.svg", "supportedCurrencies": ["EUR"], "uiPosition": 9, "code": "NTSBDEB1XXX"}, {"name": "Sparda Bank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/sparda.png", "supportedCurrencies": ["EUR"], "uiPosition": 10, "code": "GENODEF1S04"}, {"name": "Comdirect", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/comdirect.png", "supportedCurrencies": ["EUR"], "uiPosition": 11, "code": "COBADEHD"}, {"name": "Revolut Germany", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 12, "code": "RVUALT2V"}]}, "PL": {"supportedCurrencies": ["EUR", "PLN"], "paymentMethods": [{"name": "Revolut Poland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR", "PLN"], "uiPosition": 1, "code": "RVUALT2V"}, {"name": "PKO Bank Polski", "logoUrl": "https://public.montonio.com/images/aspsps_logos/pko-polski.png", "supportedCurrencies": ["PLN"], "uiPosition": 2, "code": "BPKOPLPW"}, {"name": "Pekao", "logoUrl": "https://public.montonio.com/images/aspsps_logos/pekao.png", "supportedCurrencies": ["PLN"], "uiPosition": 3, "code": "PKOPPLPW"}, {"name": "mBank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/mbank.png", "supportedCurrencies": ["PLN"], "uiPosition": 4, "code": "BREXPLPW"}, {"name": "Santander Bank Polska", "logoUrl": "https://public.montonio.com/images/aspsps_logos/santander.png", "supportedCurrencies": ["PLN"], "uiPosition": 5, "code": "WBKPPLPP"}, {"name": "Ing Poland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/ing.png", "supportedCurrencies": ["PLN"], "uiPosition": 6, "code": "INGBPLPW"}, {"name": "Alior", "logoUrl": "https://public.montonio.com/images/aspsps_logos/alior.png", "supportedCurrencies": ["PLN"], "uiPosition": 7, "code": "ALBPPLPW"}, {"name": "BNP Paribas", "logoUrl": "https://public.montonio.com/images/aspsps_logos/bnp-paribas.png", "supportedCurrencies": ["PLN"], "uiPosition": 8, "code": "PPABPLPK"}, {"name": "Millenium", "logoUrl": "https://public.montonio.com/images/aspsps_logos/millennium.png", "supportedCurrencies": ["PLN"], "uiPosition": 9, "code": "BIGBPLPW"}, {"name": "Inteligo", "logoUrl": "https://public.montonio.com/images/aspsps_logos/inteligo.png", "supportedCurrencies": ["PLN"], "uiPosition": 10, "code": "IBNKPAPA"}, {"name": "Credit Agricole", "logoUrl": "https://public.montonio.com/images/aspsps_logos/credit-agricole.png", "supportedCurrencies": ["PLN"], "uiPosition": 11, "code": "AGRIPLPR"}, {"name": "N26 Poland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/n26.svg", "supportedCurrencies": ["EUR"], "uiPosition": 12, "code": "NTSBDEB1XXX"}]}, "LV": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "Revolut Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "RVUALT2V"}, {"name": "Swedbank Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/swedbank.png", "supportedCurrencies": ["EUR"], "uiPosition": 2, "code": "HABALV22"}, {"name": "SEB Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/seb.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "UNLALV2X"}, {"name": "Citadele Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/citadele.png", "supportedCurrencies": ["EUR"], "uiPosition": 4, "code": "PARXLV22"}, {"name": "Luminor Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/luminor.png", "supportedCurrencies": ["EUR"], "uiPosition": 5, "code": "RIKOLV2X"}]}, "LT": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "Swedbank Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/swedbank.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "HABALT22"}, {"name": "SEB Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/seb.png", "supportedCurrencies": ["EUR"], "uiPosition": 2, "code": "CBVILT2X"}, {"name": "Luminor Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/luminor.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "AGBLLT2X"}, {"name": "\u0160iauli\u0173 bankas", "logoUrl": "https://public.montonio.com/images/aspsps_logos/siauliu.png", "supportedCurrencies": ["EUR"], "uiPosition": 4, "code": "CBSBLT26"}, {"name": "Citadele Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/citadele.png", "supportedCurrencies": ["EUR"], "uiPosition": 5, "code": "INDULT2X"}, {"name": "Revolut Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 6, "code": "RVUALT2V"}]}, "FI": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "OP Financial Group", "logoUrl": "https://public.montonio.com/images/aspsps_logos/op.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "OKOYFIHH"}, {"name": "Nordea", "logoUrl": "https://public.montonio.com/images/aspsps_logos/nordea.png", "supportedCurrencies": ["EUR"], "uiPosition": 2, "code": "NDEAFIHH"}, {"name": "Danske Bank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/danske.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "DABAFIHH"}, {"name": "S\u00e4\u00e4st\u00f6pankki", "logoUrl": "https://public.montonio.com/images/aspsps_logos/saastopankki.png", "supportedCurrencies": ["EUR"], "uiPosition": 4, "code": "ITELFIHH"}, {"name": "POP Pankki", "logoUrl": "https://public.montonio.com/images/aspsps_logos/pop.png", "supportedCurrencies": ["EUR"], "uiPosition": 5, "code": "POPFFI22"}, {"name": "Oma S\u00e4\u00e4st\u00f6pankki", "logoUrl": "https://public.montonio.com/images/aspsps_logos/omasp.png", "supportedCurrencies": ["EUR"], "uiPosition": 6, "code": "OMSAFI2S"}, {"name": "S-Pankki", "logoUrl": "https://public.montonio.com/images/aspsps_logos/s-pankki.png", "supportedCurrencies": ["EUR"], "uiPosition": 7, "code": "SBANFIHH"}, {"name": "Alandsbanken", "logoUrl": "https://public.montonio.com/images/aspsps_logos/alandsbanken-fi.png", "supportedCurrencies": ["EUR"], "uiPosition": 8, "code": "AABAFI22"}, {"name": "Handelsbanken", "logoUrl": "https://public.montonio.com/images/aspsps_logos/handelsbanken.png", "supportedCurrencies": ["EUR"], "uiPosition": 9, "code": "HANDFIHH"}, {"name": "Revolut Finland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 10, "code": "RVUALT2V"}, {"name": "N26 Finland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/n26.svg", "supportedCurrencies": ["EUR"], "uiPosition": 11, "code": "NTSBDEB1XXX"}]}, "EE": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "Swedbank Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/swedbank.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "HABAEE2X"}, {"name": "SEB Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/seb.png", "supportedCurrencies": ["EUR"], "uiPosition": 2, "code": "EEUHEE2X"}, {"name": "LHV Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/lhv.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "LHVBEE22"}, {"name": "Luminor Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/luminor.png", "supportedCurrencies": ["EUR"], "uiPosition": 4, "code": "RIKOEE22"}, {"name": "Coop Pank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/coop.png", "supportedCurrencies": ["EUR"], "uiPosition": 5, "code": "EKRDEE22"}, {"name": "Citadele Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/citadele.png", "supportedCurrencies": ["EUR"], "uiPosition": 6, "code": "PARXEE22"}, {"name": "Revolut Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 7, "code": "RVUALT2V"}, {"name": "N26 Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/n26.svg", "supportedCurrencies": ["EUR"], "uiPosition": 8, "code": "NTSBDEB1XXX"}]}}}, "cardPayments": {"processor": "stripe"}, "blik": {"processor": "stripe"}}}',
                currency: 'EUR',
                targetId: 'montonio-checkout',
                defaultRegion: 'EE',
                inputName: 'preferred-bank',
                regionInputName: 'preferred-region'
            })
            checkout.init();
        }
        // You can then listen to the submit button and get the values of the input values.
        // The bank identifier and preferred region will appear under your specified name.
        var form = document.getElementById('my-checkout');
        form.addEventListener("submit", (e) => {
            e.preventDefault();
            var formData = form.elements;
            var output = {
                // "csrfmiddlewaretoken": form.elements['csrfmiddlewaretoken'].value,
                // "User": form.elements['montonio-checkout-user'].value,
                // "Amount": form.elements['montonio-checkout-amount'].value,
                "Amount": form.elements['amountother'].value ? form.elements['amountother'].value : form.elements['amount'].value,
                // "Amount2": form.elements['amountother'].value,
                "TargetFund": form.elements['donation_type'].value,
                "Preferred region": form.elements['preferred-region'].value,
                "Preferred provider": form.elements['preferred-bank'].value,
            }
            console.log(output);
            // alert(JSON.stringify(output, null, 2))
            let csrftoken = '{{ csrf_token }}'
            fetch('/montonio/get_order/', {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrftoken,
                },
                body: JSON.stringify(output)
            })
            .then(response => response.json())
            .then(response => setAnswer(JSON.stringify(response)))
        })
    </script>
    <!-- Don't forget to include the script tag -->
    <script src="https://public.montonio.com/assets/montonio-js/1.x/montonio.bundle.js"></script>
</body>
</html>