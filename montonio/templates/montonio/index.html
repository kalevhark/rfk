<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Montonio SDK</title>
</head>
<body>
    <form id="my-checkout" novalidate>
{#        {% csrf_token %}#}
        <input id="montonio-checkout-user" name="montonio-checkout-user" type="text" placeholder="Nimi" value="" />
        <input id="montonio-checkout-amount" name="montonio-checkout-amount" type="text" placeholder="Summa" value="9.99" />
        <!-- This is the target div -->
        <div id="montonio-checkout"></div>
        <button type="submit">Submit</button>
    </form>
    <div id="answer"></div>

    <script>
        function setAnswer(text) {
          answer.innerHTML = text;
        }

        // Make sure to wrap your code in the window.onMontonioLoaded function
        window.onMontonioLoaded = function() {
            var checkout = Montonio.Checkout.PaymentInitiation.create({
                accessKey: '{{ my_access_key}}',
                // The JSON string obtained from the HTTP request GET /stores/payment-methods.
                storeSetupData: '{"uuid": "b6080898-2d54-4fd0-85c8-8ae628c9f976", "name": "Valga G\u00fcmnaasiumi Vilistlaskogu", "paymentMethods": {"paymentInitiation": {"processor": "montonio", "setup": {"DE": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "Sparkasse", "logoUrl": "https://public.montonio.com/images/aspsps_logos/sparkasse.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "DEMO_UI_GROUPED"}, {"name": "Ing DiBa", "logoUrl": "https://public.montonio.com/images/aspsps_logos/ing.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "INGDDEFF"}, {"name": "Deutsche Bank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/deutschebank.png", "supportedCurrencies": ["EUR"], "uiPosition": 6, "code": "DEUTDEFFXXX"}, {"name": "Noris Bank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/noris.png", "supportedCurrencies": ["EUR"], "uiPosition": 7, "code": "NORSDE51XXX"}, {"name": "Commerzbank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/commerzbank.png", "supportedCurrencies": ["EUR"], "uiPosition": 8, "code": "COBADEFF"}, {"name": "N26 Germany", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/n26.svg", "supportedCurrencies": ["EUR"], "uiPosition": 9, "code": "NTSBDEB1XXX"}, {"name": "Sparda Bank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/sparda.png", "supportedCurrencies": ["EUR"], "uiPosition": 10, "code": "GENODEF1S04"}, {"name": "Comdirect", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/comdirect.png", "supportedCurrencies": ["EUR"], "uiPosition": 11, "code": "COBADEHD"}, {"name": "Revolut Germany", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 12, "code": "RVUALT2V"}]}, "PL": {"supportedCurrencies": ["EUR", "PLN"], "paymentMethods": [{"name": "Revolut Poland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR", "PLN"], "uiPosition": 1, "code": "RVUALT2V"}, {"name": "PKO Bank Polski", "logoUrl": "https://public.montonio.com/images/aspsps_logos/pko-polski.png", "supportedCurrencies": ["PLN"], "uiPosition": 2, "code": "BPKOPLPW"}, {"name": "Pekao", "logoUrl": "https://public.montonio.com/images/aspsps_logos/pekao.png", "supportedCurrencies": ["PLN"], "uiPosition": 3, "code": "PKOPPLPW"}, {"name": "mBank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/mbank.png", "supportedCurrencies": ["PLN"], "uiPosition": 4, "code": "BREXPLPW"}, {"name": "Santander Bank Polska", "logoUrl": "https://public.montonio.com/images/aspsps_logos/santander.png", "supportedCurrencies": ["PLN"], "uiPosition": 5, "code": "WBKPPLPP"}, {"name": "Ing Poland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/ing.png", "supportedCurrencies": ["PLN"], "uiPosition": 6, "code": "INGBPLPW"}, {"name": "Alior", "logoUrl": "https://public.montonio.com/images/aspsps_logos/alior.png", "supportedCurrencies": ["PLN"], "uiPosition": 7, "code": "ALBPPLPW"}, {"name": "BNP Paribas", "logoUrl": "https://public.montonio.com/images/aspsps_logos/bnp-paribas.png", "supportedCurrencies": ["PLN"], "uiPosition": 8, "code": "PPABPLPK"}, {"name": "Millenium", "logoUrl": "https://public.montonio.com/images/aspsps_logos/millennium.png", "supportedCurrencies": ["PLN"], "uiPosition": 9, "code": "BIGBPLPW"}, {"name": "Inteligo", "logoUrl": "https://public.montonio.com/images/aspsps_logos/inteligo.png", "supportedCurrencies": ["PLN"], "uiPosition": 10, "code": "IBNKPAPA"}, {"name": "Credit Agricole", "logoUrl": "https://public.montonio.com/images/aspsps_logos/credit-agricole.png", "supportedCurrencies": ["PLN"], "uiPosition": 11, "code": "AGRIPLPR"}, {"name": "N26 Poland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/n26.svg", "supportedCurrencies": ["EUR"], "uiPosition": 12, "code": "NTSBDEB1XXX"}]}, "LV": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "Revolut Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "RVUALT2V"}, {"name": "Swedbank Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/swedbank.png", "supportedCurrencies": ["EUR"], "uiPosition": 2, "code": "HABALV22"}, {"name": "SEB Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/seb.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "UNLALV2X"}, {"name": "Citadele Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/citadele.png", "supportedCurrencies": ["EUR"], "uiPosition": 4, "code": "PARXLV22"}, {"name": "Luminor Latvia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/luminor.png", "supportedCurrencies": ["EUR"], "uiPosition": 5, "code": "RIKOLV2X"}]}, "LT": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "Swedbank Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/swedbank.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "HABALT22"}, {"name": "SEB Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/seb.png", "supportedCurrencies": ["EUR"], "uiPosition": 2, "code": "CBVILT2X"}, {"name": "Luminor Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/luminor.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "AGBLLT2X"}, {"name": "\u0160iauli\u0173 bankas", "logoUrl": "https://public.montonio.com/images/aspsps_logos/siauliu.png", "supportedCurrencies": ["EUR"], "uiPosition": 4, "code": "CBSBLT26"}, {"name": "Citadele Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/citadele.png", "supportedCurrencies": ["EUR"], "uiPosition": 5, "code": "INDULT2X"}, {"name": "Revolut Lithuania", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 6, "code": "RVUALT2V"}]}, "FI": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "OP Financial Group", "logoUrl": "https://public.montonio.com/images/aspsps_logos/op.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "OKOYFIHH"}, {"name": "Nordea", "logoUrl": "https://public.montonio.com/images/aspsps_logos/nordea.png", "supportedCurrencies": ["EUR"], "uiPosition": 2, "code": "NDEAFIHH"}, {"name": "Danske Bank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/danske.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "DABAFIHH"}, {"name": "S\u00e4\u00e4st\u00f6pankki", "logoUrl": "https://public.montonio.com/images/aspsps_logos/saastopankki.png", "supportedCurrencies": ["EUR"], "uiPosition": 4, "code": "ITELFIHH"}, {"name": "POP Pankki", "logoUrl": "https://public.montonio.com/images/aspsps_logos/pop.png", "supportedCurrencies": ["EUR"], "uiPosition": 5, "code": "POPFFI22"}, {"name": "Oma S\u00e4\u00e4st\u00f6pankki", "logoUrl": "https://public.montonio.com/images/aspsps_logos/omasp.png", "supportedCurrencies": ["EUR"], "uiPosition": 6, "code": "OMSAFI2S"}, {"name": "S-Pankki", "logoUrl": "https://public.montonio.com/images/aspsps_logos/s-pankki.png", "supportedCurrencies": ["EUR"], "uiPosition": 7, "code": "SBANFIHH"}, {"name": "Alandsbanken", "logoUrl": "https://public.montonio.com/images/aspsps_logos/alandsbanken-fi.png", "supportedCurrencies": ["EUR"], "uiPosition": 8, "code": "AABAFI22"}, {"name": "Handelsbanken", "logoUrl": "https://public.montonio.com/images/aspsps_logos/handelsbanken.png", "supportedCurrencies": ["EUR"], "uiPosition": 9, "code": "HANDFIHH"}, {"name": "Revolut Finland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 10, "code": "RVUALT2V"}, {"name": "N26 Finland", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/n26.svg", "supportedCurrencies": ["EUR"], "uiPosition": 11, "code": "NTSBDEB1XXX"}]}, "EE": {"supportedCurrencies": ["EUR"], "paymentMethods": [{"name": "Swedbank Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/swedbank.png", "supportedCurrencies": ["EUR"], "uiPosition": 1, "code": "HABAEE2X"}, {"name": "SEB Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/seb.png", "supportedCurrencies": ["EUR"], "uiPosition": 2, "code": "EEUHEE2X"}, {"name": "LHV Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/lhv.png", "supportedCurrencies": ["EUR"], "uiPosition": 3, "code": "LHVBEE22"}, {"name": "Luminor Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/luminor.png", "supportedCurrencies": ["EUR"], "uiPosition": 4, "code": "RIKOEE22"}, {"name": "Coop Pank", "logoUrl": "https://public.montonio.com/images/aspsps_logos/coop.png", "supportedCurrencies": ["EUR"], "uiPosition": 5, "code": "EKRDEE22"}, {"name": "Citadele Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/citadele.png", "supportedCurrencies": ["EUR"], "uiPosition": 6, "code": "PARXEE22"}, {"name": "Revolut Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/revolut.png", "supportedCurrencies": ["EUR"], "uiPosition": 7, "code": "RVUALT2V"}, {"name": "N26 Estonia", "logoUrl": "https://public.montonio.com/images/aspsps_logos/v2/n26.svg", "supportedCurrencies": ["EUR"], "uiPosition": 8, "code": "NTSBDEB1XXX"}]}}}, "cardPayments": {"processor": "stripe"}, "blik": {"processor": "stripe"}}}',
                currency: 'EUR',
                targetId: 'montonio-checkout',
                defaultRegion: 'EE',
                inputName: 'preferred-bank',
                regionInputName: 'preferred-region'
            })
            checkout.init();
        }
        // You can then listen to the submit button and get the values of the input values.
        // The bank identifier and preferred region will appear under your specified name.
        var form = document.getElementById('my-checkout');
        form.addEventListener("submit", (e) => {
            e.preventDefault();
            var formData = form.elements;
            var output = {
                // "csrfmiddlewaretoken": form.elements['csrfmiddlewaretoken'].value,
                "User": form.elements['montonio-checkout-user'].value,
                "Amount": form.elements['montonio-checkout-amount'].value,
                "Preferred region": form.elements['preferred-region'].value,
                "Preferred provider": form.elements['preferred-bank'].value,
            }
            // alert(JSON.stringify(output, null, 2))
            let csrftoken = '{{ csrf_token }}'
            fetch('/montonio/get_order/', {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrftoken,
                },
                body: JSON.stringify(output)
            })
            .then(response => response.json())
            .then(response => setAnswer('Serveri vastus: ' + JSON.stringify(response)))
        })
    </script>
    <!-- Don't forget to include the script tag -->
    <script src="https://public.montonio.com/assets/montonio-js/1.x/montonio.bundle.js"></script>
</body>
</html>